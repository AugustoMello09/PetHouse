create table tb_cargo (id bigint generated by default as identity, authority varchar(255) not null, primary key (id));
create table tb_carrinho (id uuid not null, primary key (id));
create table tb_carrinho_produto (preco numeric(38,2), quantidade integer not null, produto_id bigint not null, carrinho_id uuid not null, img TEXT, nome varchar(255), primary key (produto_id, carrinho_id));
create table tb_categoria (id bigint generated by default as identity, nome_categoria varchar(255) not null, primary key (id));
create table tb_historico (id uuid not null, primary key (id));
create table tb_historico_pedidos (historico_id uuid not null, pedidos_id uuid not null unique);
create table tb_item_pedido (preco numeric(38,2), quantidade integer not null, produto_id bigint not null, pedido_id uuid not null, img TEXT, primary key (produto_id, pedido_id));
create table tb_pedido (data date not null, pagamento tinyint check (pagamento between 0 and 2), status tinyint check (status between 0 and 1), carrinho_id uuid, id uuid not null, usuario_id uuid, primary key (id));
create table tb_plano (plano tinyint not null check (plano between 0 and 2), preco numeric(38,2) not null, id bigint generated by default as identity, descricao TEXT not null, nome varchar(255) not null, primary key (id));
create table tb_produto (preco numeric(38,2) not null, tipo tinyint not null check (tipo between 0 and 1), categoria_id bigint, id bigint generated by default as identity, descricao TEXT not null, img TEXT, nome varchar(255) not null, primary key (id));
create table tb_usuario (plano_id bigint unique, carrinho_id uuid unique, historico_id uuid unique, id uuid not null, cpf_cnpj varchar(255) not null, email varchar(255) not null, nome varchar(255) not null, senha varchar(255) not null, primary key (id));
create table tb_usuario_cargo (cargo_id bigint not null, usuario_id uuid not null, primary key (cargo_id, usuario_id));
alter table if exists tb_carrinho_produto add constraint FK9udyd44syvrsy7frbcpygo6mn foreign key (carrinho_id) references tb_carrinho;
alter table if exists tb_carrinho_produto add constraint FKgw2frropyqfxagwdkmhsevhp6 foreign key (produto_id) references tb_produto;
alter table if exists tb_historico_pedidos add constraint FKjyh1axq7gydu38m2fg3twu9q5 foreign key (pedidos_id) references tb_pedido;
alter table if exists tb_historico_pedidos add constraint FKol6njxj0jc80cku40iuuwvaxe foreign key (historico_id) references tb_historico;
alter table if exists tb_item_pedido add constraint FK3qvnhpdyxagngbf1t326cvnse foreign key (pedido_id) references tb_pedido;
alter table if exists tb_item_pedido add constraint FKgfmv77km3wt2evaaq2vkiv2oj foreign key (produto_id) references tb_produto;
alter table if exists tb_pedido add constraint FKgch7ub6vvk98jibobyd95isri foreign key (carrinho_id) references tb_carrinho;
alter table if exists tb_pedido add constraint FK5h0d3j6fio8o9dmrdwd1n58k1 foreign key (usuario_id) references tb_usuario;
alter table if exists tb_produto add constraint FK1ksfe2oumgjxke3oc5op41lej foreign key (categoria_id) references tb_categoria;
alter table if exists tb_usuario add constraint FK4a6uire4wxu3xt1yh7km3o377 foreign key (carrinho_id) references tb_carrinho;
alter table if exists tb_usuario add constraint FK1prtn1tfxo8ly1rrys0ommvq3 foreign key (historico_id) references tb_historico;
alter table if exists tb_usuario add constraint FKgx3figo8bmyutg0cy6vustook foreign key (plano_id) references tb_plano;
alter table if exists tb_usuario_cargo add constraint FKfoxfmrp32u59p9yvguydp9ybj foreign key (cargo_id) references tb_cargo;
alter table if exists tb_usuario_cargo add constraint FKdaew2172j172duhsiyma5rfq5 foreign key (usuario_id) references tb_usuario;